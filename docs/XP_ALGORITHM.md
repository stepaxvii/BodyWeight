# –ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è XP

**–í–µ—Ä—Å–∏—è**: 2.0  
**–î–∞—Ç–∞**: 01.01.2026  
**–°—Ç–∞—Ç—É—Å**: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **XP –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –∑–∞ –∫–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ –æ—Ç–¥–µ–ª—å–Ω–æ**
2. **–ö–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ –¥–∞—ë—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—ã–π XP** (–æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤)
3. **Volume multiplier –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –ø–æ–¥—Ö–æ–¥—É** (–Ω–µ –∫ —Å—É–º–º–µ)
4. **Backend - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã** –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á—ë—Ç–∞
5. **Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞

---

## üìê –§–æ—Ä–º—É–ª–∞ XP –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

```
XP_–∑–∞_–ø–æ–¥—Ö–æ–¥ = base_xp √ó difficulty_mult √ó volume_mult √ó streak_mult √ó first_bonus
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ñ–æ—Ä–º—É–ª—ã

#### 1. base_xp
- –ë–∞–∑–æ–≤—ã–π XP —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
- –ü—Ä–∏–º–µ—Ä—ã: –æ—Ç–∂–∏–º–∞–Ω–∏—è = 5, –ø–ª–∞–Ω–∫–∞ = 8, L-—Å–∏–¥–µ–Ω–∏–µ = 15

#### 2. difficulty_mult (–º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏)
```
difficulty_mult = 1 + (difficulty - 1) √ó 0.25
```

| –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ú–Ω–æ–∂–∏—Ç–µ–ª—å |
|-----------|-----------|
| ‚òÖ (1) | √ó1.0 |
| ‚òÖ‚òÖ (2) | √ó1.25 |
| ‚òÖ‚òÖ‚òÖ (3) | √ó1.5 |
| ‚òÖ‚òÖ‚òÖ‚òÖ (4) | √ó1.75 |
| ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (5) | √ó2.0 |

#### 3. volume_mult (–º–Ω–æ–∂–∏—Ç–µ–ª—å –æ–±—ä—ë–º–∞)
–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ **–∫–∞–∂–¥–æ–º—É –ø–æ–¥—Ö–æ–¥—É –æ—Ç–¥–µ–ª—å–Ω–æ**:

```
–µ—Å–ª–∏ reps ‚â§ 20:
    volume_mult = 1 + reps √ó 0.02
    (–æ—Ç 1.0 –¥–æ 1.4)
–∏–Ω–∞—á–µ:
    volume_mult = 1.4 + (reps - 20) √ó 0.01
    (–º–µ–¥–ª–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –ø–æ—Å–ª–µ 20)
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- 10 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: `1 + 10 √ó 0.02 = 1.2`
- 20 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: `1 + 20 √ó 0.02 = 1.4`
- 30 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: `1.4 + (30-20) √ó 0.01 = 1.5`
- 50 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π: `1.4 + (50-20) √ó 0.01 = 1.7`

#### 4. streak_mult (–º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–µ—Ä–∏–∏)
```
streak_mult = 1 + min(streak_days, 30) √ó 0.0167
```

| –°–µ—Ä–∏—è | –ú–Ω–æ–∂–∏—Ç–µ–ª—å |
|-------|-----------|
| 0 –¥–Ω–µ–π | √ó1.0 |
| 7 –¥–Ω–µ–π | √ó1.12 |
| 14 –¥–Ω–µ–π | √ó1.23 |
| 30+ –¥–Ω–µ–π | √ó1.5 (–º–∞–∫—Å–∏–º—É–º) |

#### 5. first_bonus (–±–æ–Ω—É—Å –ø–µ—Ä–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –¥–Ω—è)
```
first_bonus = 1.2 (–µ—Å–ª–∏ –ø–µ—Ä–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è)
            = 1.0 (–∏–Ω–∞—á–µ)
```

---

## ‚è±Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ timed —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

–î–ª—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –Ω–∞ –≤—Ä–µ–º—è (–ø–ª–∞–Ω–∫–∞, —Ä–∞—Å—Ç—è–∂–∫–∞, L-—Å–∏–¥–µ–Ω–∏–µ):
- **10 —Å–µ–∫—É–Ω–¥ = 1 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ** (rep equivalent)
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è: `reps_value = floor(seconds / 10)`
- –ú–∏–Ω–∏–º—É–º: `reps_value = max(1, floor(seconds / 10))`

**–ü—Ä–∏–º–µ—Ä—ã:**
- 30 —Å–µ–∫—É–Ω–¥ ‚Üí 3 rep equivalent
- 60 —Å–µ–∫—É–Ω–¥ ‚Üí 6 rep equivalent
- 120 —Å–µ–∫—É–Ω–¥ ‚Üí 12 rep equivalent

---

## üîÑ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á—ë—Ç–∞ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

### Backend (workout_processor.py)

```python
total_xp = 0

for exercise_data in workout.exercises:
    exercise = get_exercise(exercise_data.slug)
    
    for set_value in exercise_data.sets:
        # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–ª—è timed —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π
        if exercise.is_timed:
            reps_for_xp = max(1, set_value // 10)  # —Å–µ–∫—É–Ω–¥—ã ‚Üí rep equivalent
        else:
            reps_for_xp = set_value  # –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
        
        # –†–∞—Å—á—ë—Ç XP –¥–ª—è —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
        set_xp = calculate_xp(
            base_xp=exercise.base_xp,
            difficulty=exercise.difficulty,
            reps=reps_for_xp,  # –¥–ª—è –≠–¢–û–ì–û –ø–æ–¥—Ö–æ–¥–∞
            streak_days=user.current_streak,
            is_first_today=is_first_today,
        )
        
        total_xp += set_xp
```

### Frontend (workout/+page.svelte)

```typescript
let total = 0;

workoutStore.exerciseData.forEach(data => {
    if (!data.exercise || data.sets.length === 0) {
        return;
    }
    
    const baseXp = data.exercise.base_xp;
    const difficultyMult = 1 + (data.exercise.difficulty - 1) * 0.25;
    
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
    data.sets.forEach(setValue => {
        let repsValue: number;
        if (data.isTimed) {
            repsValue = Math.max(1, Math.floor(setValue / 10));
        } else {
            repsValue = setValue;
        }
        
        // Volume multiplier –¥–ª—è –≠–¢–û–ì–û –ø–æ–¥—Ö–æ–¥–∞
        let volumeMult: number;
        if (repsValue <= 20) {
            volumeMult = 1 + repsValue * 0.02;
        } else {
            volumeMult = 1.4 + (repsValue - 20) * 0.01;
        }
        
        // –ë–ï–ó streak –∏ first bonus (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞)
        total += baseXp * difficultyMult * volumeMult;
    });
});
```

---

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á—ë—Ç–∞

### –ü—Ä–∏–º–µ—Ä 1: –û—Ç–∂–∏–º–∞–Ω–∏—è, 3 –ø–æ–¥—Ö–æ–¥–∞ –ø–æ 20 –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π

**–î–∞–Ω–Ω—ã–µ:**
- base_xp = 5
- difficulty = 2 (‚òÖ‚òÖ)
- difficulty_mult = 1.25
- streak = 7 –¥–Ω–µ–π ‚Üí streak_mult = 1.12
- first_bonus = 1.2

**–†–∞—Å—á—ë—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
```
–ü–æ–¥—Ö–æ–¥ 1 (20 –ø–æ–≤—Ç):
  volume_mult = 1 + 20 √ó 0.02 = 1.4
  XP = 5 √ó 1.25 √ó 1.4 √ó 1.12 √ó 1.2 = 11.76 ‚Üí 11 XP

–ü–æ–¥—Ö–æ–¥ 2 (20 –ø–æ–≤—Ç):
  volume_mult = 1.4 (—Ç–∞–∫–æ–π –∂–µ)
  XP = 5 √ó 1.25 √ó 1.4 √ó 1.12 √ó 1.2 = 11.76 ‚Üí 11 XP

–ü–æ–¥—Ö–æ–¥ 3 (20 –ø–æ–≤—Ç):
  volume_mult = 1.4 (—Ç–∞–∫–æ–π –∂–µ)
  XP = 5 √ó 1.25 √ó 1.4 √ó 1.12 √ó 1.2 = 11.76 ‚Üí 11 XP

–ò—Ç–æ–≥–æ: 11 + 11 + 11 = 33 XP
```

### –ü—Ä–∏–º–µ—Ä 2: L-—Å–∏–¥–µ–Ω–∏–µ, 2 –ø–æ–¥—Ö–æ–¥–∞ –ø–æ 30 —Å–µ–∫—É–Ω–¥

**–î–∞–Ω–Ω—ã–µ:**
- base_xp = 15
- difficulty = 4 (‚òÖ‚òÖ‚òÖ‚òÖ)
- difficulty_mult = 1.75
- streak = 0 –¥–Ω–µ–π ‚Üí streak_mult = 1.0
- first_bonus = 1.0

**–†–∞—Å—á—ë—Ç:**
```
–ü–æ–¥—Ö–æ–¥ 1 (30 —Å–µ–∫ = 3 rep):
  volume_mult = 1 + 3 √ó 0.02 = 1.06
  XP = 15 √ó 1.75 √ó 1.06 √ó 1.0 √ó 1.0 = 27.825 ‚Üí 27 XP

–ü–æ–¥—Ö–æ–¥ 2 (30 —Å–µ–∫ = 3 rep):
  volume_mult = 1.06 (—Ç–∞–∫–æ–π –∂–µ)
  XP = 15 √ó 1.75 √ó 1.06 √ó 1.0 √ó 1.0 = 27.825 ‚Üí 27 XP

–ò—Ç–æ–≥–æ: 27 + 27 = 54 XP
```

### –ü—Ä–∏–º–µ—Ä 3: –û—Ç–∂–∏–º–∞–Ω–∏—è, 1 –ø–æ–¥—Ö–æ–¥ 10 –ø–æ–≤—Ç, –∑–∞—Ç–µ–º 1 –ø–æ–¥—Ö–æ–¥ 30 –ø–æ–≤—Ç

**–†–∞—Å—á—ë—Ç:**
```
–ü–æ–¥—Ö–æ–¥ 1 (10 –ø–æ–≤—Ç):
  volume_mult = 1 + 10 √ó 0.02 = 1.2
  XP = 5 √ó 1.25 √ó 1.2 √ó 1.0 √ó 1.0 = 7.5 ‚Üí 7 XP

–ü–æ–¥—Ö–æ–¥ 2 (30 –ø–æ–≤—Ç):
  volume_mult = 1.4 + (30-20) √ó 0.01 = 1.5
  XP = 5 √ó 1.25 √ó 1.5 √ó 1.0 √ó 1.0 = 9.375 ‚Üí 9 XP

–ò—Ç–æ–≥–æ: 7 + 9 = 16 XP
```

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª–∞

1. **–ö–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ** - –Ω–µ—Ç —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–¥ —Ä–∞—Å—á—ë—Ç–æ–º
2. **Volume multiplier –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –ø–æ–¥—Ö–æ–¥—É** - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–æ–¥—Ö–æ–¥—ã –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π XP
3. **Timed —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è** - 10 —Å–µ–∫ = 1 rep
4. **Streak –∏ first bonus –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–æ–¥—Ö–æ–¥–∞–º** - –æ–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –≤—Å–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
5. **Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ** - –±–µ–∑ streak –∏ first bonus

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å

### Backend
1. `workout_processor.py` - –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ü–∏–∫–ª —Ä–∞—Å—á—ë—Ç–∞ XP
2. `xp_calculator.py` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º—É–ª—É (—É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è)

### Frontend
1. `workout/+page.svelte` - –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å `estimatedXp`
2. `workout.svelte.ts` - –æ–±–Ω–æ–≤–∏—Ç—å `estimatedXp` getter (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞

**–û–¥–∏–Ω –ø–æ–¥—Ö–æ–¥:**
```
XP = base_xp √ó difficulty_mult √ó volume_mult(reps) √ó streak_mult √ó first_bonus
```

**–í—Å—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞:**
```
total_xp = sum(XP_–∑–∞_–∫–∞–∂–¥—ã–π_–ø–æ–¥—Ö–æ–¥)
```

**–í–∞–∂–Ω–æ:** –ö–∞–∂–¥—ã–π –ø–æ–¥—Ö–æ–¥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –∑–∞—Ç–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—É–º–º–∏—Ä—É—é—Ç—Å—è.

