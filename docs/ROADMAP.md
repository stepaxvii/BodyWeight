# BodyWeight - План развития платформы

## Текущая версия: v3.6

### Что уже реализовано
- 242 упражнения с прогрессиями
- Система уровней и XP
- Монеты и магазин
- Достижения (20+)
- Streak-система
- Кастомные программы тренировок
- Лидерборд (глобальный, недельный, друзья)
- Система друзей
- Уведомления в приложении
- 12 аватаров
- Telegram Mini App интеграция

---

## Фаза 1: Геймификация 2.0

### 1.1 Ежедневные задания
**Приоритет:** Высокий
**Сложность:** Средняя

Система из 3 случайных заданий каждый день:
- "Сделай 50 отжиманий"
- "Тренируйся 15 минут"
- "Выполни 3 разных упражнения"

**Награды:**
- За каждое задание: 10-30 монет
- За все 3: бонус 50 монет

**Требуется:**
- [ ] Таблица `daily_quests` (user_id, quest_type, target, progress, completed, date)
- [ ] Генератор заданий (рандом из пула)
- [ ] API: GET /quests/daily, POST /quests/:id/claim
- [ ] UI: Секция на главной странице

---

### 1.2 Система титулов
**Приоритет:** Высокий
**Сложность:** Низкая

Текстовые звания под ником пользователя:
- Базовые (бесплатные): "Новичок", "Спортсмен", "Атлет"
- Покупные: "Железный воин", "Легенда фитнеса"
- За достижения: "Мастер планки", "Король отжиманий"

**Требуется:**
- [ ] Расширить таблицу shop_items (item_type='title')
- [ ] Поле equipped_title_id в users
- [ ] API: экипировка титула
- [ ] UI: отображение в профиле и лидерборде

---

### 1.3 Рамки для аватаров
**Приоритет:** Средний
**Сложность:** Средняя

Декоративные рамки вокруг аватара:
- Обычные: серая, синяя
- Редкие: золотая, огненная
- Эпические: анимированные (неоновая, электрическая)
- Легендарные: с эффектами частиц

**Требуется:**
- [ ] SVG-спрайты рамок
- [ ] Таблица frames или расширение shop_items
- [ ] Поле equipped_frame_id в users
- [ ] Компонент AvatarWithFrame

---

### 1.4 Сезонные события
**Приоритет:** Средний
**Сложность:** Высокая

Временные события с эксклюзивными наградами:
- Новогодний марафон (декабрь-январь)
- Весенняя перезагрузка (март)
- Летний челлендж (июнь-август)
- Хэллоуин (октябрь)

**Механика:**
- Специальные задания на период события
- Очки события за выполнение
- Эксклюзивные награды (аватары, рамки, титулы)
- Лидерборд события

**Требуется:**
- [ ] Таблица events (id, name, start_date, end_date, rewards)
- [ ] Таблица event_progress (user_id, event_id, points)
- [ ] Система специальных заданий
- [ ] Тематические UI-элементы

---

## Фаза 2: Аналитика и прогресс

### 2.1 Календарь тренировок
**Приоритет:** Высокий
**Сложность:** Средняя

Тепловая карта активности (как GitHub contributions):
- Цвет ячейки = интенсивность тренировки
- Клик на день = детали тренировки
- Streak-визуализация

**Требуется:**
- [ ] Компонент ActivityCalendar (Svelte)
- [ ] API: GET /users/me/activity?year=2025
- [ ] Страница /profile/activity

---

### 2.2 Графики прогресса
**Приоритет:** Средний
**Сложность:** Средняя

Визуализация роста:
- XP по неделям/месяцам (линейный график)
- Количество тренировок (столбчатая диаграмма)
- Распределение по категориям (круговая)

**Требуется:**
- [ ] Библиотека графиков (Chart.js или D3.js-lite)
- [ ] API агрегации данных
- [ ] Страница /profile/stats

---

### 2.3 Личные рекорды (PR)
**Приоритет:** Высокий
**Сложность:** Низкая

Автоматическое отслеживание:
- Лучший сет (макс повторений за подход)
- Лучший день (макс повторений за день)
- Самая длинная тренировка
- Самый длинный streak

**Требуется:**
- [ ] Расширить user_exercise_progress (best_single_day, best_workout_reps)
- [ ] Триггеры обновления при завершении тренировки
- [ ] UI: секция "Личные рекорды" в профиле
- [ ] Уведомление при побитии рекорда

---

### 2.4 Статистика по упражнениям
**Приоритет:** Средний
**Сложность:** Низкая

Детальная информация по каждому упражнению:
- Всего выполнено (повторений)
- Сколько раз делал
- Последний раз
- Прогресс по времени

**Требуется:**
- [ ] Страница /exercises/:slug/stats
- [ ] Графики прогресса по упражнению
- [ ] Сравнение с другими пользователями (перцентиль)

---

## Фаза 3: Соревнования

### 3.1 Еженедельные челленджи
**Приоритет:** Высокий
**Сложность:** Средняя

Глобальные соревнования каждую неделю:
- "Кто больше отожмётся"
- "Максимум XP за неделю"
- "Больше всех тренировок"

**Награды:**
- Топ-1: 500 монет + эксклюзивный титул
- Топ-10: 200 монет
- Топ-100: 50 монет
- Участие: 10 монет

**Требуется:**
- [ ] Таблица weekly_challenges (id, type, start_date, end_date)
- [ ] Таблица challenge_leaderboard (challenge_id, user_id, score)
- [ ] Автоматическая генерация челленджей (CRON)
- [ ] UI: страница /challenges

---

### 3.2 Дуэли с друзьями
**Приоритет:** Средний
**Сложность:** Средняя

Вызов друга на соревнование:
- Выбор упражнения
- Период (1 день, 3 дня, неделя)
- Цель (больше повторений)

**Требуется:**
- [ ] Таблица duels (id, challenger_id, opponent_id, exercise_id, duration, status)
- [ ] API: создание, принятие, отклонение дуэли
- [ ] Уведомления о вызовах
- [ ] UI: секция дуэлей в друзьях

---

### 3.3 Команды/Кланы
**Приоритет:** Низкий
**Сложность:** Высокая

Создание и вступление в команды:
- Командный лидерборд
- Командные челленджи
- Чат команды (опционально)

**Требуется:**
- [ ] Таблица teams (id, name, avatar, leader_id)
- [ ] Таблица team_members (team_id, user_id, role)
- [ ] Командная статистика
- [ ] UI: страница /teams

---

## Фаза 4: Умные функции

### 4.1 Рекомендации упражнений
**Приоритет:** Средний
**Сложность:** Средняя

Персональные рекомендации:
- "Давно не делал: подтягивания" (7+ дней)
- "Попробуй новое: пистолетик" (никогда не делал)
- "Пора усложнить: алмазные отжимания" (100+ обычных)

**Требуется:**
- [ ] Алгоритм анализа истории
- [ ] API: GET /recommendations
- [ ] UI: карусель рекомендаций на главной

---

### 4.2 Готовые программы
**Приоритет:** Высокий
**Сложность:** Средняя

Автоматические программы с прогрессией:
- "Первое подтягивание за 30 дней"
- "100 отжиманий за 6 недель"
- "Растяжка на шпагат"

**Структура:**
- День 1-7: базовые упражнения
- День 8-14: увеличение объёма
- День 15-21: добавление сложности
- День 22-30: целевое упражнение

**Требуется:**
- [ ] Таблица programs (id, name, duration_days, exercises_json)
- [ ] Таблица user_programs (user_id, program_id, current_day, started_at)
- [ ] UI: страница /programs
- [ ] Уведомления о дне программы

---

### 4.3 Таймер отдыха
**Приоритет:** Высокий
**Сложность:** Низкая

Таймер между подходами:
- Настраиваемое время (30с, 60с, 90с, 120с)
- Звуковой сигнал
- Вибрация (Telegram haptic)

**Требуется:**
- [ ] Компонент RestTimer
- [ ] Настройка в профиле (default_rest_time)
- [ ] Интеграция в RoutinePlayer

---

### 4.4 Дни отдыха
**Приоритет:** Низкий
**Сложность:** Низкая

Отслеживание восстановления:
- Рекомендация отдыха после тяжёлых тренировок
- Не ломать streak за запланированный отдых
- Советы по восстановлению

**Требуется:**
- [ ] Поле planned_rest_days в users (JSON массив дней недели)
- [ ] Логика streak с учётом отдыха
- [ ] UI: настройка дней отдыха

---

## Фаза 5: UX улучшения

### 5.1 Звуковые эффекты
**Приоритет:** Средний
**Сложность:** Низкая

8-bit звуки для:
- Получение достижения
- Level up
- Завершение тренировки
- Побитие рекорда

**Требуется:**
- [ ] Аудио файлы (8-bit style)
- [ ] Сервис воспроизведения
- [ ] Настройка вкл/выкл в профиле

---

### 5.2 Шаринг результатов
**Приоритет:** Средний
**Сложность:** Средняя

Красивая картинка для шаринга:
- Итоги тренировки
- Новое достижение
- Streak milestone
- Недельная статистика

**Требуется:**
- [ ] Canvas/SVG генератор картинок
- [ ] API: GET /share/workout/:id (возвращает PNG)
- [ ] Интеграция с Telegram share

---

### 5.3 Улучшенный онбординг
**Приоритет:** Средний
**Сложность:** Средняя

Интерактивный туториал:
- Выбор целей (похудеть, набрать силу, растяжка)
- Оценка уровня (тест из 3-5 упражнений)
- Персональные рекомендации

**Требуется:**
- [ ] Расширенные слайды онбординга
- [ ] Сохранение целей пользователя
- [ ] Адаптация рекомендаций под цели

---

## Фаза 6: Техническое улучшение

### 6.1 Тестирование
**Приоритет:** Высокий
**Сложность:** Средняя

- [ ] Unit-тесты бэкенда (pytest)
- [ ] Интеграционные тесты API
- [ ] E2E тесты фронтенда (Playwright)
- [ ] Тесты XP/Level калькуляторов

---

### 6.2 Кэширование
**Приоритет:** Средний
**Сложность:** Средняя

- [ ] Redis для сессий
- [ ] Кэш лидерборда (5 мин TTL)
- [ ] Кэш списка упражнений
- [ ] CDN для статики

---

### 6.3 Мониторинг
**Приоритет:** Средний
**Сложность:** Низкая

- [ ] Sentry для ошибок
- [ ] Prometheus метрики
- [ ] Grafana дашборды
- [ ] Алерты в Telegram

---

## Приоритеты на ближайший месяц

### Неделя 1-2
1. Ежедневные задания (1.1)
2. Титулы (1.2)
3. Таймер отдыха (4.3)

### Неделя 3-4
4. Календарь тренировок (2.1)
5. Личные рекорды (2.3)
6. Еженедельные челленджи (3.1)

### Месяц 2
7. Рамки для аватаров (1.3)
8. Готовые программы (4.2)
9. Рекомендации упражнений (4.1)

### Месяц 3
10. Графики прогресса (2.2)
11. Дуэли с друзьями (3.2)
12. Шаринг результатов (5.2)

---

## Метрики успеха

| Метрика | Текущее | Цель (3 мес) |
|---------|---------|--------------|
| DAU | ? | +50% |
| Retention D7 | ? | 40% |
| Retention D30 | ? | 20% |
| Avg тренировок/нед | ? | 3.5 |
| Avg streak | ? | 7 дней |

---

## Потенциальная монетизация

### Telegram Stars (нативная валюта)
- Premium аватары: 50-200 Stars
- Эксклюзивные рамки: 100-500 Stars
- Ранний доступ к функциям: 200 Stars/мес

### Подписка Premium
- Расширенная аналитика
- Неограниченные кастомные программы
- Персональные рекомендации AI
- Без рекламы (если будет)

---

*Документ создан: декабрь 2024*
*Последнее обновление: v3.6*
