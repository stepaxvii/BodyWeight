# 🎨 Новая система визуализации упражнений - Как это выглядит

## 📋 Обзор

Вместо анимированных SVG, где кадры накладываются друг на друга, теперь используется **коллаж из статичных кадров** с возможностью детального просмотра каждой фазы.

---

## 🖼️ 1. В списке упражнений (ExerciseCard)

### Было (v3.0):
```
┌────────────────────────────────┐
│ [📊] Отжимания        ? ❤      │
│      ★★★☆☆  +15 XP            │
│      [анимация - кадры мерцают]│
└────────────────────────────────┘
```

### Стало (v4.0):
```
┌──────────────────────────────────────────────┐
│ [📊] Отжимания                      ? ❤      │
│      ★★★☆☆  +15 XP                          │
│                                              │
│  ┌────┐ → ┌────┐ → ┌────┐                  │
│  │ 🧍 │   │ 🧎 │   │ 🤸 │                  │
│  │    │   │    │   │    │                  │
│  └────┘   └────┘   └────┘                  │
│  START    MIDWAY   BOTTOM                    │
└──────────────────────────────────────────────┘
```

**Преимущества:**
- ✅ Сразу понятна последовательность движения
- ✅ Никаких глюков с наложением кадров
- ✅ Более детализированная графика
- ✅ Профессиональный вид

---

## 🔍 2. В модальном окне (ExerciseInfoModal)

### Компонент ExerciseFrameViewer - покадровый просмотр

```
┌─────────────────────────────────────────┐
│         ОТЖИМАНИЯ (PUSHUP)              │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │         [Детальный кадр]        │   │
│  │                                 │   │
│  │      🧍 с подписями:            │   │
│  │      • Arms straight            │   │
│  │      • Body aligned             │   │
│  │      • 90° в локтях ←показано   │   │
│  │                                 │   │
│  └─────────────────────────────────┘   │
│                                         │
│       ◄  ● ○ ○  ►                      │
│     (свайп или кнопки)                  │
│                                         │
│   📍 НАЧАЛЬНАЯ ПОЗИЦИЯ                  │
│                                         │
├─────────────────────────────────────────┤
│ ⭐ Сложность: ★★★☆☆                     │
│ 🏆 XP: +15                              │
│                                         │
│ 📝 Техника выполнения:                  │
│ Встаньте в упор лёжа, руки на ширине    │
│ плеч. Опуститесь, сгибая руки до 90°.   │
│ Вернитесь в исходное положение.         │
│                                         │
│ 💪 Группы мышц:                         │
│ [Грудь] [Трицепс] [Плечи] [Кор]        │
└─────────────────────────────────────────┘
```

**Возможности:**
- 🔄 Свайп между кадрами (touch-friendly для Telegram)
- ⬅️ ➡️ Кнопки навигации
- 🔘 Точки-индикаторы текущего кадра
- 📍 Подпись фазы движения
- 🔍 Крупная детализация с аннотациями

---

## 📱 3. Во время тренировки (RoutinePlayer)

```
┌─────────────────────────────────────────┐
│  Упражнение 3/10                        │
│  ПРИСЕДАНИЯ                             │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │    [Текущий кадр в цикле]       │   │
│  │                                 │   │
│  │    🧍 → 🧎 → 🏋                 │   │
│  │    (автопереключение каждые     │   │
│  │     0.8 сек для динамики)       │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ⏱️ 00:45  |  12 повторений             │
│                                         │
│  [━━━━━━━━━━━━━━━━━━━━━] 80%          │
│                                         │
│  👀 Совет: Держите спину прямо!        │
└─────────────────────────────────────────┘
```

---

## 🎯 4. Для статических упражнений (Plank)

```
┌─────────────────────────────────────────┐
│              ПЛАНКА                     │
├─────────────────────────────────────────┤
│                                         │
│  ┌─────────────────────────────────┐   │
│  │                                 │   │
│  │       🧍━━━━━                   │   │
│  │       │                         │   │
│  │      ┃ ← линия выравнивания     │   │
│  │      ● ← ключевые точки         │   │
│  │                                 │   │
│  │    [HOLD] ← пульсирует          │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ✓ Делай:          ✗ Не делай:         │
│  • Прямая линия    • Провисание таза   │
│  • Напряги кор     • Подъём ягодиц     │
│                                         │
│  ⏱️ 00:30                               │
└─────────────────────────────────────────┘
```

---

## 💻 Интеграция в код

### Использование в ExerciseCard:
```svelte
<script>
  import ExercisePreview from '$lib/components/ui/ExercisePreview.svelte';
</script>

<ExercisePreview
  exercise="pushup-regular"
  size="md"
  version="v4"  <!-- новый формат -->
/>
```

### Использование в ExerciseInfoModal:
```svelte
<script>
  import ExerciseFrameViewer from '$lib/components/ui/ExerciseFrameViewer.svelte';
</script>

<ExerciseFrameViewer
  exercise="pushup-regular"
  currentFrame={1}
  onFrameChange={(frame) => console.log(frame)}
/>
```

---

## 📦 Файловая структура

```
sprites/exercises/
├── pushup-regular/
│   ├── preview.svg      ← коллаж 3 кадра (для списка)
│   ├── frame-1.svg      ← детальный кадр 1
│   ├── frame-2.svg      ← детальный кадр 2
│   └── frame-3.svg      ← детальный кадр 3
├── squat-regular/
│   ├── preview.svg
│   ├── frame-1.svg
│   ├── frame-2.svg
│   └── frame-3.svg
├── plank/
│   └── preview.svg      ← статика с подсказками
└── jumping-jack.svg     ← старый формат (v3.0)
```

---

## 🔄 Миграция

### Автоматический fallback:
Компонент `ExercisePreview` автоматически пытается:
1. Загрузить `exercises/{slug}/preview.svg` (v4)
2. Если не найдено → загружает `exercises/{slug}.svg` (v3)
3. Если не найдено → показывает placeholder

### Совместимость:
- ✅ Старые упражнения (v3.0) продолжают работать
- ✅ Новые упражнения (v4.0) показывают улучшенные коллажи
- ✅ Плавная миграция без breaking changes

---

## 🎨 Детализация

### Старый формат (v3.0):
- Пиксели: 6x6, 8x8
- Цвета: плоские (1 цвет на элемент)
- Проблема: кадры накладываются

### Новый формат (v4.0):
- Пиксели: 2x2, 3x3, 4x4 (в 2-3 раза мельче)
- Цвета: градиенты (dark/light варианты для объёма)
- Аннотации: углы, линии, подписи
- Подсказки: что делать / чего не делать

### Пример градиента:
```css
--pixel-skin: #FFD5B8;        /* основной */
--pixel-skin-dark: #E8C4A8;   /* тени */
```

```svg
<!-- Рука с объёмом -->
<rect fill="var(--pixel-skin)" />      <!-- светлая часть -->
<rect fill="var(--pixel-skin-dark)" /> <!-- тень -->
```

---

## 🚀 Следующие шаги

1. ✅ Создал примеры: pushup, squat, plank
2. 📝 Создал компоненты: ExercisePreview, ExerciseFrameViewer
3. 🔄 Нужно: конвертировать остальные ~250 упражнений
4. 🎨 Можно: добавить анимацию перехода между кадрами
5. 💡 Можно: добавить AR-режим (наложение на камеру)

---

## 📊 Производительность

### Размер файлов:
- v3.0 (анимация): ~3-5 KB на упражнение
- v4.0 (коллаж + 3 кадра): ~8-12 KB на упражнение
- Увеличение: ~2x, но качество и UX ~5x лучше

### Загрузка:
- Preview (коллаж): загружается сразу
- Frames: загружаются по требованию (lazy)
- Кэширование: browser cache + Service Worker

---

## 🎯 Результат

**Для пользователя:**
- 😊 Понятнее что делать
- 🎯 Видно все фазы движения
- 📱 Touch-friendly навигация
- 🏆 Профессиональный вид приложения

**Для разработчика:**
- 🐛 Меньше багов (нет проблем с анимацией)
- 🎨 Проще рисовать (отдельные кадры)
- 📦 Модульная структура
- 🔄 Легко обновлять
